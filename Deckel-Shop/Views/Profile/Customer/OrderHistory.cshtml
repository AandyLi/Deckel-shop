@using Microsoft.AspNetCore.Identity
@inject SignInManager<IdentityUser> SignInManager
@inject UserManager<IdentityUser> UserManager

<h1>Order History</h1>
<h3>@UserManager.GetUserAsync(User).Result.UserName</h3>

@*<h3>Name of customer</h3>*@


@model IEnumerable<Database.Models.Order>

<ul class="nav nav-tabs">
    @*<li class="nav-item">
            <a class="nav-link" asp-action="Index">Profile</a>
        </li>*@
    <li class="nav-item">
        <a class="nav-link active" asp-action="CustomerOrderHistory">Order History</a>
    </li>
    <li class="nav-item">
        <a class="nav-link" href="~/Identity/Account/Manage/">Manage account</a>
    </li>
    @*<li class="nav-item">
            <a class="nav-link disabled" href="#">Disabled</a>
        </li>*@
</ul>


<div class="row mt-3 pt-3 mb-3">
    <table class="table table-striped table-bordered dt-responsive display nowrap">
        <thead>
            <tr>
                <th>
                    ORDER#
                </th>
                <th>
                    ORDER DATE
                </th>
                <th>
                    ORDER STATUS
                </th>
                <th>
                    SHIPPING DATE
                </th>
                <th>
                    ORDER TOTAL
                </th>
                <th></th>
            </tr>
        </thead>
        <tbody class="tableSearch">
            @foreach (var order in Model)
            {

                <tr>
                    <td>
                        @order.OrderId
                    </td>
                    <td>
                        @order.OrderDate
                    </td>
                    <td>
                        @order.OrderStatus
                    </td>
                    <td>
                        @if (order.ShippingDate == DateTime.UnixEpoch)
                        {
                        <p>Not shipped</p>
                        }
                        else
                        {
                            @order.ShippingDate
                        }

                    </td>
                    <td>
                        @order.OrderTotal SEK
                    </td>
                    <td>
                        <span data-toggle="tooltip" data-placement="bottom" title="info">
                            <button type="button" onclick="GetModalInfo(@order.OrderId, 'orderDetails')" id="infoModalBtn-@order.OrderId" class="btn btn-light" data-toggle="modal" data-target="#exampleModalCenter" style="background-color:transparent">
                                <i class="fas fa-info-circle"></i>
                            </button>
                        </span>
                    </td>
                </tr>
            }
        </tbody>
    </table>
</div>

<partial name="~/Views/Shared/_OrderDetailModal.cshtml" />